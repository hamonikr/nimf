#!/usr/bin/make -f
# -*- makefile -*-
# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

%:
	dh $@ --with autoreconf

override_dh_autoreconf:
	./autogen.sh
	# stale libtool artifacts cause wrong install libdir (/usr/local) to be embedded
	# ensure a clean rebuild of modules so .la files are regenerated with correct --prefix/--libdir
	find . -name '*.la' -delete
	find . -name '*.lo' -delete
	find . -name '*.o' -delete
	find . -name '.libs' -type d -prune -exec rm -rf {} +

override_dh_auto_configure:
	dh_auto_configure -- --prefix=/usr --with-im-config-data --enable-gtk-doc --enable-gtk4 --libdir=/usr/lib/$(DEB_HOST_MULTIARCH)

override_dh_auto_clean:
	rm -rf $(STAMP_DIR) $(SOURCE_DIR)
	dh_clean

override_dh_clean:
	dh_clean
	rm -rf autom4te.cache
	rm -f aclocal.m4 config.log config.status
	rm -rf debian/tmp
	
override_dh_shlibdeps:
	dh_shlibdeps --dpkg-shlibdeps-params=--ignore-missing-info 

override_dh_auto_test:
# 	dh_auto_test || true
	echo "Skipping tests"	
